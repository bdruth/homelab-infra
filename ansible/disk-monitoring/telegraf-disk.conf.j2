# Telegraf disk monitoring configuration
# Generated by Ansible - DO NOT EDIT MANUALLY

[global_tags]
  host = "{{ inventory_hostname }}"

[agent]
  interval = "{{ telegraf_interval }}"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "{{ telegraf_flush_interval }}"
  flush_jitter = "0s"
  precision = ""
  hostname = "{{ inventory_hostname }}"
  omit_hostname = false

# InfluxDB output
[[outputs.influxdb]]
  urls = ["http://{{ influxdb_host }}:{{ influxdb_port }}"]
  database = "{{ influxdb_database }}"
  skip_database_creation = false
  timeout = "5s"

# Disk usage monitoring
[[inputs.disk]]
{% if ignore_fs_types | length > 0 %}
  ignore_fs = [{% for fs in ignore_fs_types %}"{{ fs }}"{% if not loop.last %}, {% endif %}{% endfor %}]
{% endif %}
{% if monitor_mount_points | length > 0 %}
  mount_points = [{% for mp in monitor_mount_points %}"{{ mp }}"{% if not loop.last %}, {% endif %}{% endfor %}]
{% endif %}

# Disk I/O monitoring
[[inputs.diskio]]
{% if ignore_fs_types | length > 0 %}
  skip_serial_number = true
{% endif %}